#!/usr/bin/env node

const {runCommands} = require('..');
const yargs = require('yargs');

yargs.usage(`Usage: conrun
  --command: "{\\"command\\": [\\"ls\\"], \\"options\\": {}}"
  --only: only run command
  --sequence
  --i: interactive mode
  --ws: log window size
`);

const {argv} = yargs;

const commands = Array.isArray(argv.command)? argv.command: (argv.command? [argv.command]: []);
const onlys = Array.isArray(argv.only)? argv.only: (argv.only? [argv.only]: []);

runCommands(
  commands.map((command) => JSON.parse(command)),
  {onlys, sequence: argv.sequence, interactive: argv.i, windowSize: Number(argv.ws)}
);
